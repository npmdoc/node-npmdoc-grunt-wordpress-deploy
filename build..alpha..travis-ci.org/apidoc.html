<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/webrain/grunt-wordpress-deploy"

    >grunt-wordpress-deploy (v0.0.6)</a>
</h1>
<h4>Deploy Wordpress without pain using Grunt.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.grunt-wordpress-deploy">module grunt-wordpress-deploy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.grunt-wordpress-deploy.grunt-wordpress-deploy">
            function <span class="apidocSignatureSpan"></span>grunt-wordpress-deploy
            <span class="apidocSignatureSpan">(grunt)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">grunt-wordpress-deploy.</span>util</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.grunt-wordpress-deploy.util">module grunt-wordpress-deploy.util</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.grunt-wordpress-deploy.util.init">
            function <span class="apidocSignatureSpan">grunt-wordpress-deploy.util.</span>init
            <span class="apidocSignatureSpan">(grunt)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.grunt-wordpress-deploy" id="apidoc.module.grunt-wordpress-deploy">module grunt-wordpress-deploy</a></h1>


    <h2>
        <a href="#apidoc.element.grunt-wordpress-deploy.grunt-wordpress-deploy" id="apidoc.element.grunt-wordpress-deploy.grunt-wordpress-deploy">
        function <span class="apidocSignatureSpan"></span>grunt-wordpress-deploy
        <span class="apidocSignatureSpan">(grunt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">grunt-wordpress-deploy = function (grunt) {

  grunt.initConfig({
    jshint: {
      all: [
        &#x27;Gruntfile.js&#x27;,
        &#x27;tasks/*.js&#x27;,
      ],
      options: {
        jshintrc: &#x27;.jshintrc&#x27;,
      },
    },

    clean: {
      tests: [&#x27;tmp&#x27;],
    },

    wordpressdeploy: {
      options: {
        backups_dir: &#x27;backups_dir/&#x27;,
        rsync_args: [&#x27;--verbose&#x27;, &#x27;--progress&#x27;, &#x27;-rlpt&#x27;, &#x27;--compress&#x27;, &#x27;--omit-dir-times&#x27;],
        exclusions: [&#x27;.git&#x27;, &#x27;tmp/*&#x27;, &#x27;backups_dir/&#x27;, &#x27;wp-config.php&#x27;, &#x27;composer.json&#x27;, &#x27;composer.lock&#x27;]
      },
      local: {
        title: &#x27;local&#x27;,
        database: &#x27;db_local&#x27;,
        user: &#x27;user_local&#x27;,
        pass: &#x27;pass_local&#x27;,
        host: &#x27;host_local&#x27;,
        url: &#x27;url_local&#x27;,
        path: &#x27;path_local&#x27;
      },
      production: {
        title: &#x27;staging&#x27;,
        database: &#x27;db_staging&#x27;,
        user: &#x27;user_staging&#x27;,
        pass: &#x27;pass_staging&#x27;,
        host: &#x27;host_staging&#x27;,
        url: &#x27;url_staging&#x27;,
        path: &#x27;path_staging&#x27;,
        ssh_host: &#x27;ssh_staging&#x27;
      }
    },

    nodeunit: {
      tasks: [&#x27;test/*_test.js&#x27;]
    },
  });

  grunt.loadTasks(&#x27;tasks&#x27;);

  grunt.loadNpmTasks(&#x27;grunt-contrib-jshint&#x27;);
  grunt.loadNpmTasks(&#x27;grunt-contrib-clean&#x27;);
  grunt.loadNpmTasks(&#x27;grunt-contrib-nodeunit&#x27;);

  // Whenever the &#x22;test&#x22; task is run, first clean the &#x22;tmp&#x22; dir, then run this
  // plugin&#x27;s task(s), then test the result.
  grunt.registerTask(&#x27;test&#x27;, [&#x27;clean&#x27;, &#x27;nodeunit&#x27;]);

  // By default, lint and run all tests.
  grunt.registerTask(&#x27;default&#x27;, [&#x27;jshint&#x27;, &#x27;test&#x27;]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.grunt-wordpress-deploy.util" id="apidoc.module.grunt-wordpress-deploy.util">module grunt-wordpress-deploy.util</a></h1>


    <h2>
        <a href="#apidoc.element.grunt-wordpress-deploy.util.init" id="apidoc.element.grunt-wordpress-deploy.util.init">
        function <span class="apidocSignatureSpan">grunt-wordpress-deploy.util.</span>init
        <span class="apidocSignatureSpan">(grunt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (grunt) {
  var shell = require(&#x27;shelljs&#x27;);
  var lineReader = require(&#x22;line-reader&#x22;);

  var exports = {};

  exports.db_dump = function(config, output_paths) {
    grunt.file.mkdir(output_paths.dir);

    var cmd = exports.mysqldump_cmd(config);

    var output = shell.exec(cmd, {silent: true}).output;

    grunt.file.write(output_paths.file, output);
    grunt.log.oklns(&#x22;Database DUMP succesfully exported to: &#x22; + output_paths.file);
  };

  exports.db_import = function(config, src) {
    shell.exec(exports.mysql_cmd(config, src));
    grunt.log.oklns(&#x22;Database imported succesfully&#x22;);
  };

  exports.rsync_push = function(config) {
    grunt.log.oklns(&#x22;Syncing data from &#x27;&#x22; + config.from + &#x22;&#x27; to &#x27;&#x22; + config.to + &#x22;&#x27; with rsync.&#x22;);

    var cmd = exports.rsync_push_cmd(config);
    grunt.log.writeln(cmd);

    shell.exec(cmd);

    grunt.log.oklns(&#x22;Sync completed successfully.&#x22;);
  };

  exports.rsync_pull = function(config) {
    grunt.log.oklns(&#x22;Syncing data from &#x27;&#x22; + config.from + &#x22;&#x27; to &#x27;&#x22; + config.to + &#x22;&#x27; with rsync.&#x22;);

    var cmd = exports.rsync_pull_cmd(config);
    shell.exec(cmd);

    grunt.log.oklns(&#x22;Sync completed successfully.&#x22;);
  };

  exports.generate_backup_paths = function(target, task_options) {

    var backups_dir = task_options[&#x27;backups_dir&#x27;] || &#x22;backups&#x22;;

    var directory = grunt.template.process(tpls.backup_path, {
      data: {
        backups_dir: backups_dir,
        env: target,
        date: grunt.template.today(&#x27;yyyymmdd&#x27;),
        time: grunt.template.today(&#x27;HH-MM-ss&#x27;),
      }
    });

    var filepath = directory + &#x27;/db_backup.sql&#x27;;

    return {
      dir: directory,
      file: filepath
    };
  };

  exports.compose_rsync_options = function(options) {
    var args = options.join(&#x27; &#x27;);

    return args;
  };

  exports.compose_rsync_exclusions = function(options) {
    var exclusions = &#x27;&#x27;;
    var i = 0;

    for(i = 0;i &#x3c; options.length; i++) {
      exclusions += &#x22;--exclude &#x27;&#x22; + options[i] + &#x22;&#x27; &#x22;;
    }

    exclusions = exclusions.trim();

    return exclusions;
  };

  exports.db_adapt = function(old_url, new_url, file) {
    grunt.log.oklns(&#x22;Adapt the database: set the correct urls for the destination in the database.&#x22;);
    var content = grunt.file.read(file);

    var output = exports.replace_urls(old_url, new_url, content);

    grunt.file.write(file, output);
  };

  exports.replace_urls = function(search, replace, content) {
    content = exports.replace_urls_in_serialized(search, replace, content);
    content = exports.replace_urls_in_string(search, replace, content);

    return content;
  };

  exports.replace_urls_in_serialized = function(search, replace, string) {
    var length_delta = search.length - replace.length;
    var search_regexp = new RegExp(search, &#x27;g&#x27;);

    // Replace for serialized data
    var matches, length, delimiter, old_serialized_data, target_string, new_url, occurences;
    var regexp = /s:(\d+):([\\]*[&#x27;&#x22;])(.*?)\2;/g;

    while (matches = regexp.exec(string)) {
      old_serialized_data = matches[0];
      target_string = matches[3];

      // If the string contains the url make the substitution
      if (target_string.indexOf(search) !== -1) {
        occurences = target_string.match(search_regexp).length;
        length = matches[1];
        delimiter = matches[2];

        // Replace the url
        new_url = target_string.replace(search_regexp, replace);
        length -= length_delta * occurences;

        // Compose the new serialized data
        var new_serialized_data = &#x27;s:&#x27; + length + &#x27;:&#x27; + delimiter + new_url + delimiter + &#x27;;&#x27;;

        // Replace the new serialized data into the dump
        string = string.replace(old_serialized_data, new_serialized_data);
      }
    }

    return string;
  };

  exports.replace_urls_in_string = function (search, replace, string) {
    var regexp = new RegExp(&#x27;(?!&#x27; + replace + &#x27;)(&#x27; + search + &#x27;)&#x27;, &#x27;g&#x27;);
    return string.replace(regexp, replace);
  };

<span class="apidocCodeCommentSpan">  /* Commands generators */
</span>  exports.mysqldump_cmd = function(config) {
    var cmd = grunt.template.process(tpls.mysqldump, {
      data: ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Copyright (c) 2013 Webrain
 * Licensed under the MIT license.
 */

&#x27;use strict&#x27;;

var grunt = require(&#x27;grunt&#x27;);
var util  = require(&#x27;../tasks/lib/util.js&#x27;).<span class="apidocCodeKeywordSpan">init</span>(grunt);

module.exports = function(grunt) {

/**
 * DB PUSH
 * pushes local database to remote database
 */
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
